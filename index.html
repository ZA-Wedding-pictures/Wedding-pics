<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Share your photos and videos with us!</title>
  <!-- Google font to match your palette -->
  <link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:wght@400;600&display=swap" rel="stylesheet">
  <style>
    :root {
      --page-bg: #fafafa;
      --text-primary: #333333;
      --accent: #5C1D13;
      --accent-light: #d6a96e;
      --card-bg: #ffffff;
      --shadow-color: rgba(0,0,0,0.1);
    }

    /* ---- layout ---- */
    body {
      margin: 0;
      padding: 0 1rem;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Arial, sans-serif;
      background: var(--page-bg);
      color: var(--text-primary);
      line-height: 1.6;
      min-height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    h1, h2, h3 {
      margin: 0;
      font-family: 'Cormorant Garamond', serif;
      color: var(--accent);
    }

    .card {
      background: var(--card-bg);
      border-radius: 16px;
      box-shadow: 0 4px 12px var(--shadow-color);
      padding: 2rem 2.5rem;
      max-width: 460px;
      width: 100%;
      text-align: center;
    }

    /* ---- form elements ---- */
    input[type=file],
    button {
      font: inherit;
      padding: 0.75rem 1rem;
      border: 1px solid #dddddd;
      border-radius: 8px;
      width: 100%;
      box-sizing: border-box;
    }

    button {
      background: var(--accent);
      color: #fff;
      border: none;
      margin-top: 1rem;
      cursor: pointer;
      transition: background 0.3s;
    }
    button:hover:not(:disabled) {
      background: var(--accent-light);
    }
    button:disabled {
      background: #cccccc;
      cursor: not-allowed;
    }

    #msg {
      margin-top: 1rem;
      font-size: 0.95rem;
    }

    /* ---- spinner ---- */
    .spinner {
      width: 24px;
      height: 24px;
      border: 4px solid var(--accent-light);
      border-top-color: var(--accent);
      border-radius: 50%;
      animation: spin 1s linear infinite;
      margin: 1rem auto 0;
    }
    @keyframes spin {
      to { transform: rotate(360deg); }
    }
    .hidden { display: none; }
  </style>
</head>
<body>
  <div class="card">
    <h2>Share your photos and videos with us!</h2>
    <p>Choose as many files as you like â€“ theyâ€™ll upload in full quality.</p>

    <input type="file" id="file" accept="image/*,video/*" multiple />
    <button id="send">Upload</button>
    <div id="msg"></div>
    <div id="spinner" class="spinner hidden"></div>
  </div>

  <script>
  // Paste your Apps Script endpoint here if it changes
  const ENDPOINT = 'https://script.google.com/macros/s/AKfycbwqtZqANbZ5thblNKsQdNwAdH1z5bqBKM3uMClYBeLSoxYd6CY-HuxfpYpHODHxuxur/exec';

  document.getElementById('send').onclick = () => uploadFiles();

  async function uploadFiles() {
    const input  = document.getElementById('file');
    const files  = input.files;
    if (!files.length) {
      alert('Pick at least one file first!');
      return;
    }

    toggleUI(true);
    try {
      for (const file of files) {
        await uploadSingle(file);   // sequential keeps quotas happier
      }
      showMessage('Thank you so much for celebrating with us. Lots of love, Adiba & Zac ðŸ¥°', true);
      input.value = '';
    } catch (err) {
      console.error(err);
      showMessage('âŒ Something went wrong â€“ please try again.');
    } finally {
      toggleUI(false);
    }
  }

  function toggleUI(isUploading) {
    document.getElementById('spinner').classList.toggle('hidden', !isUploading);
    document.getElementById('send').disabled = isUploading;
    if (isUploading) {
      showMessage('Uploadingâ€¦, sorry it\'s taking a while');
    }
  }

  function showMessage(text, ok = false) {
    const el = document.getElementById('msg');
    el.textContent = text;
    el.style.color = ok ? 'var(--accent)' : 'inherit';
  }

  function fileToBase64(file) {
    return new Promise((resolve, reject) => {
      const reader = new FileReader();
      reader.onload = () => {
        const b64 = reader.result.split(',')[1]; // strip the data: prefix
        resolve(b64);
      };
      reader.onerror = reject;
      reader.readAsDataURL(file);
    });
  }

  async function uploadSingle(file) {
    const b64  = await fileToBase64(file);
    const body = new URLSearchParams({
      data:     b64,
      filename: file.name,
      mimetype: file.type || 'application/octet-stream'
    });
    const res = await fetch(ENDPOINT, { method: 'POST', body });
    if (!res.ok) throw new Error(res.statusText);
  }
  </script>
</body>
</html>
